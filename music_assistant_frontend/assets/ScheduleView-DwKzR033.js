import{d as A,r as b,o as B,b as u,e as d,f as a,H as l,a1 as o,E as n,$ as g,u as i,aN as C,D as k,F as L,M as P,ay as V,O as D,I as E,aP as U,ad as X}from"./lucide-CUgULc1Y.js";import{C as Y}from"./Container-kU18v4Tv.js";import{L as j}from"./ListItem-DNExfS_J.js";import{_ as $}from"./index-Df_fN0sv.js";import{c as h,e as x,_ as H}from"./index-BhoKnNWl.js";import{u as O}from"./vue-router-Y1UxNETo.js";import{l as R,b as T,a4 as q}from"./vuetify-DpejJ-DC.js";import{u as G}from"./vue-i18n-Cet7hT3m.js";import"./index-kQIztB-E.js";import"./Button-BYrAilMh.js";import"./utils-CDN07tui.js";import"./reka-ui-CPonaMqy.js";import"./vueuse-BUvXlxtB.js";import"./qrcode-CK8KsgMo.js";import"./marked-C0Rlrcoy.js";import"./color-BDgtjUiw.js";/* empty css            */import"./swiper-HCRODQv4.js";const J={class:"schedule-view"},K={class:"schedule-header"},Q={class:"text-h5"},W={key:0,class:"loading-state"},Z={class:"schedule-name"},ee={class:"schedule-meta"},se={class:"schedule-time"},te={class:"schedule-days"},ae={key:0,class:"schedule-playing"},le={class:"schedule-status"},oe={key:2,class:"empty-state"},ne={class:"empty-title"},de={class:"empty-message"},ie=A({name:"ScheduleView",__name:"ScheduleView",setup(ce){const f=O(),{t:r}=G(),c=b([]),m=b(!0),S=["mon","tue","wed","thu","fri","sat","sun"],N=e=>e.length===7?r("schedule.every_day"):e.length===5&&e.every(s=>s<5)?r("schedule.weekdays"):e.length===2&&e.includes(5)&&e.includes(6)?r("schedule.weekends"):e.map(s=>r(`days.${S[s]}`)).join(", "),p=async()=>{m.value=!0;try{c.value=await h.sendCommand("schedule/all")}catch(e){console.error("Failed to load schedules:",e),c.value=[]}m.value=!1},y=()=>{f.push("/schedule/new")},v=e=>{f.push(`/schedule/${e}/edit`)},w=async e=>{try{await h.sendCommand("schedule/enable",{schedule_id:e.schedule_id,enabled:!e.enabled}),e.enabled=!e.enabled}catch(s){console.error("Failed to toggle schedule:",s)}},F=async e=>{if(confirm(r("schedule.confirm_delete")))try{await h.sendCommand("schedule/delete",{schedule_id:e.schedule_id}),c.value=c.value.filter(s=>s.schedule_id!==e.schedule_id)}catch(s){console.error("Failed to delete schedule:",s)}},z=async e=>{try{await h.sendCommand("schedule/trigger",{schedule_id:e.schedule_id}),await p()}catch(s){console.error("Failed to trigger schedule:",s)}},M=async e=>{try{await h.sendCommand("schedule/stop",{schedule_id:e.schedule_id}),await p()}catch(s){console.error("Failed to stop schedule:",s)}},I=(e,s)=>{const t=[{label:"edit",labelArgs:[],action:()=>v(s.schedule_id),icon:"mdi-pencil"},{label:s.state==="playing"?"schedule.stop":"schedule.trigger_now",labelArgs:[],action:()=>s.state==="playing"?M(s):z(s),icon:s.state==="playing"?"mdi-stop":"mdi-play"},{label:s.enabled?"settings.disable":"settings.enable",labelArgs:[],action:()=>w(s),icon:s.enabled?"mdi-toggle-switch-off":"mdi-toggle-switch"},{label:"settings.delete",labelArgs:[],action:()=>F(s),icon:"mdi-delete"}];x.emit("contextmenu",{items:t,posX:e.clientX,posY:e.clientY})};return B(()=>{p()}),(e,s)=>(d(),u("div",J,[a("div",K,[a("h1",Q,o(e.$t("schedule.title")),1),l(i($),{onClick:y},{default:n(()=>[l(i(C),{class:"size-4"}),g(" "+o(e.$t("schedule.new")),1)]),_:1})]),l(Y,{variant:"default",class:"mt-4"},{default:n(()=>[m.value?(d(),u("div",W,[l(R,{indeterminate:""})])):c.value.length>0?(d(),k(T,{key:1,class:"schedule-list"},{default:n(()=>[(d(!0),u(L,null,P(c.value,t=>(d(),k(j,{key:t.schedule_id,link:"","show-menu-btn":!0,onClick:_=>v(t.schedule_id),onMenu:_=>I(_,t)},{prepend:n(()=>[a("div",{class:X(["schedule-icon",{active:t.enabled&&t.state==="playing"}])},[l(i(V),{class:"size-10"})],2)]),title:n(()=>[a("div",Z,o(t.name),1)]),subtitle:n(()=>[a("div",ee,[a("span",se,o(t.start_time)+" - "+o(t.end_time),1),a("span",te,o(N(t.days_of_week)),1),t.state==="playing"?(d(),u("span",ae,[l(i(U),{class:"size-3"}),g(" "+o(e.$t("state.playing")),1)])):E("",!0)])]),append:n(()=>[a("div",le,[l(q,{"model-value":t.enabled,"hide-details":"",density:"compact",color:"primary","onUpdate:modelValue":_=>w(t),onClick:s[0]||(s[0]=D(()=>{},["stop"]))},null,8,["model-value","onUpdate:modelValue"])])]),_:2},1032,["onClick","onMenu"]))),128))]),_:1})):(d(),u("div",oe,[l(i(V),{class:"empty-icon size-16"}),a("div",ne,o(e.$t("schedule.no_schedules")),1),a("div",de,o(e.$t("schedule.no_schedules_detail")),1),l(i($),{class:"mt-4",onClick:y},{default:n(()=>[l(i(C),{class:"size-4"}),g(" "+o(e.$t("schedule.new")),1)]),_:1})]))]),_:1})]))}}),Fe=H(ie,[["__scopeId","data-v-8268cc97"]]);export{Fe as default};
